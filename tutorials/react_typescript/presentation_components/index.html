<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Presentation and Container Components</title>
    
        <link rel="icon"
              href="../../../_static/jetbrains_favicon.ico"/>
    
    <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css"
          rel="stylesheet">
    <script src="../../../_static/kaybee_bulma.bundle.js"></script>
    <script src="../../../_static/app.bundle.js"></script>
</head>
<body>

<section>
    <nav id="kbb-navbar" class="navbar is-success"
     role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="../../../index.html">
            
            <img src="../../../_static/PyCharm_Logo.svg.png"
                 alt="PyCharm Logo Alt">
        </a>
        <button class="button navbar-burger" data-target="navMenu">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </div>
    <div class="navbar-menu" id="navMenu">
        <div class="navbar-start">
            
                <a class="navbar-item"
                   href="../../../tips/index.html">
                    Tips
                </a>
            
                <a class="navbar-item is-active"
                   href="../../index.html">
                    Tutorials
                </a>
            
                <a class="navbar-item"
                   href="../../../articles/index.html">
                    Articles
                </a>
            
                <a class="navbar-item"
                   href="../../../blogposts/index.html">
                    Blog Posts
                </a>
            
                <a class="navbar-item"
                   href="../../../webinars/index.html">
                    Webinars
                </a>
            
                <a class="navbar-item"
                   href="../../../technologies/index.html">
                    Technologies
                </a>
            
                <a class="navbar-item"
                   href="../../../topics/index.html">
                    Topics
                </a>
            
                <a class="navbar-item"
                   href="../../../authors/index.html">
                    Authors
                </a>
            

        </div>

        <div class="navbar-end">
            
            
        </div>
    </div>
</nav>
</section>
<section
        class="hero is-success"
        style="">
    <div class="hero-head">
    </div>
    
</section>

<section class="section content tutorialstep"
         id="kbb-sphinx-body">
    
    <div class="container">
        <div class="columns">
            <div class="column sb_body">
                <nav class="breadcrumb has-arrow-separator is-small"
                     aria-label="breadcrumbs"
                     style="margin-bottom: 0">
                    <ul style="margin-left: 0">
                        
                            <li>
                                <a href="../../index.html">Tutorials</a>
                            </li>
                        
                            <li>
                                <a href="../index.html">React+TypeScript QuickStart</a>
                            </li>
                        
                        <li class="is-active">
                            <a href="#"
                               aria-current="page">Presentation and Container Components</a>
                        </li>
                    </ul>
                </nav>
                <div class="title is-1">
                    Presentation and Container Components
                    
    <span style="background-color: orange; color: white; font-weight: bold;
    font-size: x-small; padding: 0.5em; vertical-align: middle;
    border-radius: 25px">PRO ONLY</span>

                </div>

                <div class="subtitle is-4">Follow the React pattern of container/presentation components by refactoring the code and tests.</div>

                

                <div id="kbb-sphinx-body" class="content"><div class="section" id="presentation-and-container-components">
<h1>Presentation and Container Components<a class="headerlink" href="#presentation-and-container-components" title="Permalink to this headline">¶</a></h1>
<p>React encourages a separation of concerns. UI components, aka presentation
components, aka dumb components, are created by the bushel and managed by
container components, aka smart components. The container maintains state,
logic, and passes things into the presentation component.</p>
<p>Our Counter component is, as originally intended. Let’s make it a
presentation component by moving the state up to the container (App) and
the incrementing logic as well.</p>
<div class="section" id="counter-state">
<h2>Counter State<a class="headerlink" href="#counter-state" title="Permalink to this headline">¶</a></h2>
<p>We’ll start by removing state from the counter. Instead, the count is
passed in as a prop. Also, the dumb child component will no longer decide
the starting value, so remove <code class="docutils literal notranslate"><span class="pre">start</span></code> from the interface:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kr">interface</span> <span class="nx">ICounterProps</span> <span class="p">{</span>
    <span class="nx">label?</span>: <span class="kt">string</span>
    <span class="nx">count</span>: <span class="kt">number</span>
<span class="hll"><span class="p">}</span>
</span></pre></div>
</div>
<p>As soon as we do that, the universe starts breaking. TypeScript yells at us
in every one of our tests, as our <code class="docutils literal notranslate"><span class="pre">&lt;Counter/&gt;</span></code> component is not passing in
a required prop.</p>
<p>Too bad, TypeScript, you’ll have to wait. Next, let’s change our <code class="docutils literal notranslate"><span class="pre">Counter</span></code>
component to not have local state. We mentioned in
<a class="reference internal" href="../functional_components/index.html"><span class="doc">Functional React Components in TypeScript</span></a> that stateless presentation components
are best done with stateless functional components. Let’s change
<code class="docutils literal notranslate"><span class="pre">&lt;Counter/&gt;</span></code> to an SFC:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">Counter</span><span class="p">:</span> <span class="n">React</span><span class="o">.</span><span class="n">SFC</span><span class="o">&lt;</span><span class="n">ICounterProps</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">{</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">}</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="n">div</span>
            <span class="n">className</span><span class="o">=</span><span class="s2">&quot;counter&quot;</span>
            <span class="o">//</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{</span><span class="n">handleClick</span><span class="p">}</span>
        <span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">label</span><span class="o">&gt;</span><span class="p">{</span><span class="n">label</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">span</span><span class="o">&gt;</span><span class="p">{</span><span class="n">count</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

    <span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that we commented out, for now, the click handler. We can also delete
the <code class="docutils literal notranslate"><span class="pre">ICounterState</span></code> interface as it is no longer needed.</p>
<p>Let’s fix the first two tests, to see if we are in the ballpark:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should render a counter&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="hll">    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Counter</span> <span class="nx">count</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">);</span>
</span>    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter label&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should render a counter with custom label&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="hll">    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Counter</span> <span class="nx">label</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Current&#39;</span><span class="p">}</span> <span class="nx">count</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">);</span>
</span>    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter label&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Current&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>These two tests now pass.</p>
<p>Since the <code class="docutils literal notranslate"><span class="pre">&lt;Counter/&gt;</span></code> component no longer controls the starting value,
you can remove the
<code class="docutils literal notranslate"><span class="pre">should</span> <span class="pre">default</span> <span class="pre">start</span> <span class="pre">at</span> <span class="pre">zero</span></code> and
<code class="docutils literal notranslate"><span class="pre">should</span> <span class="pre">custom</span> <span class="pre">start</span> <span class="pre">at</span> <span class="pre">another</span> <span class="pre">value</span></code> tests from <code class="docutils literal notranslate"><span class="pre">Counter.test.tsx</span></code>.</p>
</div>
<div class="section" id="passing-in-click-function">
<h2>Passing In Click Function<a class="headerlink" href="#passing-in-click-function" title="Permalink to this headline">¶</a></h2>
<p>The child component is no longer responsible for the count value. It’s passed
in from the parent, which keeps track of the state. So how do we handle
clicks?</p>
<p>It sounds weird, but…in the same way. We’re going to pass in an arrow
function from the parent. Meaning, the parent contains all the logic for what
happens when there is a click. All the child needs to know is “when the click
event comes in, call the function that was passed to me as a prop”.</p>
<p>Here goes. First, since this click handler function will come in as a prop,
we need to change <code class="docutils literal notranslate"><span class="pre">ICounterProps</span></code> to model it:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kr">interface</span> <span class="nx">ICounterProps</span> <span class="p">{</span>
    <span class="nx">label?</span>: <span class="kt">string</span>
    <span class="nx">count</span>: <span class="kt">number</span>
    <span class="nx">onCounterIncrease</span><span class="o">:</span> <span class="p">(</span><span class="nx">event</span>: <span class="kt">React.MouseEvent</span><span class="o">&lt;</span><span class="nx">HTMLElement</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now <em>that’s</em> an interface, baby. It captures quite a bit of the contract.</p>
<p>Next, use ES6 object destructuring to “unpack” that from the props into the
local scope, then refer to that prop in the <code class="docutils literal notranslate"><span class="pre">onClick</span></code> handler:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">Counter</span><span class="p">:</span> <span class="n">React</span><span class="o">.</span><span class="n">SFC</span><span class="o">&lt;</span><span class="n">ICounterProps</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">{</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">onCounterIncrease</span><span class="p">}</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="n">div</span>
            <span class="n">className</span><span class="o">=</span><span class="s2">&quot;counter&quot;</span>
            <span class="n">onClick</span><span class="o">=</span><span class="p">{</span><span class="n">onCounterIncrease</span><span class="p">}</span>
        <span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">label</span><span class="o">&gt;</span><span class="p">{</span><span class="n">label</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">span</span><span class="o">&gt;</span><span class="p">{</span><span class="n">count</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

    <span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that the IDE, as you did the unpacking, knew how to autocomplete
<code class="docutils literal notranslate"><span class="pre">onCounterIncrease</span></code>.</p>
<p>Our tests, though, are having compiler trouble again. We broke the component
contract, because <code class="docutils literal notranslate"><span class="pre">onCounterIncrease</span></code> is a mandatory prop. It’s easy to
shut up this test, because we aren’t testing click handling:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Counter</span> <span class="nx">count</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="nx">onCounterIncrease</span><span class="o">=</span><span class="p">{</span><span class="nx">handler</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">);</span>
</pre></div>
</div>
<p>We used <a class="reference internal" href="../../../technologies/jest.html" title="Jest"><em>Jest</em></a> mock functions to create a disposable arrow
function which we passed in as a prop.</p>
<p>Do this for both tests:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should render a counter&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Counter</span> <span class="nx">count</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span>
                                     <span class="nx">onCounterIncrease</span><span class="o">=</span><span class="p">{</span><span class="nx">handler</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter label&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should render a counter with custom label&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Counter</span> <span class="nx">label</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Current&#39;</span><span class="p">}</span> <span class="nx">count</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span>
                                     <span class="nx">onCounterIncrease</span><span class="o">=</span><span class="p">{</span><span class="nx">handler</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter label&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Current&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Event handling is a bit trickier. We need a “spy” that tells whether our
passed-in handler gets called, and called the right way. Also, we don’t
test whether the value updates, since the container is responsible for
that.</p>
<p>Let’s change the third test:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should call the handler on click&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Counter</span> <span class="nx">count</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="nx">onCounterIncrease</span><span class="o">=</span><span class="p">{</span><span class="nx">handler</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">);</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter&#39;</span><span class="p">).</span><span class="nx">simulate</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">shiftKey</span>: <span class="kt">false</span><span class="p">});</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">handler</span><span class="p">).</span><span class="nx">toBeCalledWith</span><span class="p">({</span><span class="nx">shiftKey</span>: <span class="kt">false</span><span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>We’re simply ensuring that clicking the value calls the callback. We could
delete the last test, as it isn’t the responsibility of the <code class="docutils literal notranslate"><span class="pre">&lt;Counter/&gt;</span></code>
to handle the click. All the logic is in container, not the presentation
component.</p>
</div>
<div class="section" id="dumb-component-gets-a-little-smarter">
<h2>Dumb Component Gets a Little Smarter<a class="headerlink" href="#dumb-component-gets-a-little-smarter" title="Permalink to this headline">¶</a></h2>
<p>But is that strictly true? What if the presentation component took care of
dissecting HTML event information, extracted the relevant data, and <em>then</em>
called the callback? That’s a better division of responsibilities. The
container would then be truly UI-less for this functionality.</p>
<p>First, let’s change the contract. Our callback will be called <em>not</em> with the
raw event, but with a boolean for the shift information:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kr">interface</span> <span class="nx">ICounterProps</span> <span class="p">{</span>
    <span class="nx">label?</span>: <span class="kt">string</span>
    <span class="nx">count</span>: <span class="kt">number</span>
    <span class="nx">onCounterIncrease</span><span class="o">:</span> <span class="p">(</span><span class="nx">isShift</span>: <span class="kt">boolean</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Our SFC gains a local arrow function which does the extraction and calling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">Counter</span><span class="p">:</span> <span class="n">React</span><span class="o">.</span><span class="n">SFC</span><span class="o">&lt;</span><span class="n">ICounterProps</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">{</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">onCounterIncrease</span><span class="p">}</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">handleClick</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">React</span><span class="o">.</span><span class="n">MouseEvent</span><span class="o">&lt;</span><span class="n">HTMLElement</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">onCounterIncrease</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">shiftKey</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="n">div</span>
            <span class="n">className</span><span class="o">=</span><span class="s2">&quot;counter&quot;</span>
            <span class="n">onClick</span><span class="o">=</span><span class="p">{</span><span class="n">handleClick</span><span class="p">}</span>
        <span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">label</span><span class="o">&gt;</span><span class="p">{</span><span class="n">label</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">span</span><span class="o">&gt;</span><span class="p">{</span><span class="n">count</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

    <span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Our third test can now change, to see if our “spy” was called with a boolean
instead of an event object:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;should call the handler on click&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">();</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Counter</span> <span class="nx">count</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="nx">onCounterIncrease</span><span class="o">=</span><span class="p">{</span><span class="nx">handler</span><span class="p">}</span><span class="o">/&gt;</span><span class="p">);</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter&#39;</span><span class="p">).</span><span class="nx">simulate</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">shiftKey</span>: <span class="kt">false</span><span class="p">});</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">handler</span><span class="p">).</span><span class="nx">toBeCalledWith</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The fourth test, for shift, can be deleted. It’s simply a variation of this
test.</p>
</div>
<div class="section" id="updating-the-container">
<h2>Updating the Container<a class="headerlink" href="#updating-the-container" title="Permalink to this headline">¶</a></h2>
<p>We now have a <code class="docutils literal notranslate"><span class="pre">&lt;Counter/&gt;</span></code> presentation component that passes tests. But
we’ve shifted some responsibility to the parent. Let’s do the updates. Start
by opening <code class="docutils literal notranslate"><span class="pre">App.tsx</span></code> and <code class="docutils literal notranslate"><span class="pre">App.test.tsx</span></code> side-by-side.</p>
<p>First, this <code class="docutils literal notranslate"><span class="pre">&lt;App/&gt;</span></code> component will now have some state. Make an interface
for it:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kr">interface</span> <span class="nx">ICounterState</span> <span class="p">{</span>
    <span class="nx">count</span>: <span class="kt">number</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Change the class setup to use this, with a constructor that sets up the
initial state:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">App</span> <span class="n">extends</span> <span class="n">React</span><span class="o">.</span><span class="n">Component</span><span class="o">&lt;</span><span class="nb">object</span><span class="p">,</span> <span class="n">ICounterState</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="n">constructor</span><span class="p">(</span><span class="n">props</span><span class="p">:</span> <span class="p">{})</span> <span class="p">{</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">count</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">};</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>Now it’s time for the action. Let’s make a method that updates the state.
This will be the handler that’s passed into <code class="docutils literal notranslate"><span class="pre">&lt;Counter/&gt;</span></code>. We first try it
as a normal method:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kr">public</span> <span class="nx">increment</span><span class="p">(</span><span class="nx">isShift</span>: <span class="kt">boolean</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">inc</span>: <span class="kt">number</span> <span class="o">=</span> <span class="nx">isShift</span> <span class="o">?</span> <span class="nx">10</span> : <span class="kt">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span>: <span class="kt">this.state.count</span> <span class="o">+</span> <span class="nx">inc</span><span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>But this is going to have the same problem discussed previously: <code class="docutils literal notranslate"><span class="pre">this</span></code> is
bound to the event, not the component. As before, we solve this by converting
the method to an arrow function class property:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kr">public</span> <span class="nx">increment</span> <span class="o">=</span> <span class="p">(</span><span class="nx">isShift</span>: <span class="kt">boolean</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">inc</span>: <span class="kt">number</span> <span class="o">=</span> <span class="nx">isShift</span> <span class="o">?</span> <span class="nx">10</span> : <span class="kt">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">count</span>: <span class="kt">this.state.count</span> <span class="o">+</span> <span class="nx">inc</span><span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With this in place, we can now update the <code class="docutils literal notranslate"><span class="pre">render</span></code> function:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="kr">public</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">Heading</span><span class="p">/&gt;</span>
            <span class="p">&lt;</span><span class="nt">Counter</span>
                <span class="na">label</span><span class="o">=</span><span class="s">{&#39;Current&#39;}</span>
                <span class="na">count</span><span class="o">=</span><span class="s">{this.state.count}</span>
                <span class="na">onCounterIncrease</span><span class="o">=</span><span class="s">{this.increment}</span>
            <span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>State is maintained in the parent which it gives to the child, along with an
update handler function.</p>
</div>
<div class="section" id="test-the-state-updater">
<h2>Test the State Updater<a class="headerlink" href="#test-the-state-updater" title="Permalink to this headline">¶</a></h2>
<p>And with that, our tests pass again. However, we have dropped any testing to
see whether the state actually updated. The responsibility is spread a bit
between the two components.</p>
<p>Let’s first write tests in <code class="docutils literal notranslate"><span class="pre">App.test.tsx</span></code> for the increment function:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;updates state when increment is called without shift&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">instance</span> <span class="o">=</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">instance</span><span class="p">()</span> <span class="kr">as</span> <span class="nx">App</span><span class="p">;</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">increment</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">it</span><span class="p">(</span><span class="s1">&#39;updates state when increment is called with shift&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">instance</span> <span class="o">=</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">instance</span><span class="p">()</span> <span class="kr">as</span> <span class="nx">App</span><span class="p">;</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">increment</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">count</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>We used Enzyme’s <code class="docutils literal notranslate"><span class="pre">instance()</span></code> method to grab the component instead of the
DOM-like node. We then called <code class="docutils literal notranslate"><span class="pre">increment</span></code> and checked to see if the parent’s
state increased appropriately.</p>
<p>Those tests pass, which is a good sign. We need though to test the
parent-child connection. For this we’ll go back to Enzyme’s <code class="docutils literal notranslate"><span class="pre">mount</span></code>:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;updates the count by 1 via the counter component&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span><span class="p">);</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter&#39;</span><span class="p">).</span><span class="nx">simulate</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">shiftKey</span>: <span class="kt">false</span><span class="p">});</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter span&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">it</span><span class="p">(</span><span class="s1">&#39;updates the count by 10 via the counter component&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span><span class="p">);</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter&#39;</span><span class="p">).</span><span class="nx">simulate</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">shiftKey</span>: <span class="kt">true</span><span class="p">});</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.counter span&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Fantastic, these tests pass. We now have enough confidence to head back
over to the browser. Fire up the <code class="docutils literal notranslate"><span class="pre">start</span></code> run config, reload the browser,
click and shift click, then shut down <code class="docutils literal notranslate"><span class="pre">start</span></code>.</p>
</div>
<div class="section" id="testing-is-cool">
<h2>Testing Is Cool<a class="headerlink" href="#testing-is-cool" title="Permalink to this headline">¶</a></h2>
<p>This was a heck of a tutorial step. Let’s take a moment and think about how
development would have gone the “normal” way. How many times would you have
switched to from IDE-&gt;browser-&gt;IDE? How many clicks would you have to do to
each time, checking that your new stuff worked and didn’t break your old
stuff? When you ran into a problem, would the browser give you a convenient
and accurate notice?</p>
<p>It’s hard to make yourself get into TDD for React and TypeScript. Once you
do, and once you get into the flow, it’s a very positive development
experience.</p>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://www.codementor.io/vijayst/unit-testing-react-components-jest-or-enzyme-du1087lh8">https://www.codementor.io/vijayst/unit-testing-react-components-jest-or-enzyme-du1087lh8</a></li>
</ul>
</div>
</div>
</div>

            </div>

            <div class="column is-3">
                <aside id="sidebarCollapseTarget" class="menu kbb-sidenav">

    <div id="kb-sidenav-published-heading">
    

    
        <p class="menu-label">
            Published
        </p>
        <ul class="menu-list">
            <li>
                Published on
                2018-02-26
                at
                12:00
                
                    by:
                    
                        <a href="../../../authors/pauleveritt/index.html">
                            <figure class="image is-rounded is-24x24"
                                    style="display: inline-block; margin: 0.5rem">
                                <img src="../../../authors/pauleveritt/paul_headshotx24.jpeg">
                            </figure>
                            <span
                                    style="display: inline-block; vertical-align: super">Paul Everitt</span>
                        </a>
                    
                
            </li>
        </ul>
    
</div>
    
    <p class="menu-label">
        Previous
    </p>
    <ul class="menu-list">
        <a href="../rich_events_and_testing/index.html"
           title="previous chapter">Rich Events and Testing</a>
    </ul>



    <p class="menu-label">
        Next
    </p>
    <ul class="menu-list">
        <a href="../routing/index.html"
           title="next chapter">TypeScript and Routing With Testing</a>
    </ul>


    
    

    
        <div>
            <p class="menu-label">
                <span style="text-transform: uppercase">technology</span>
            </p>
            <p>
                
                    <a href="../../../technologies/react.html">
                        <span class="tag">react</span>
                    </a>
                
            </p>
        </div>
    



    <p class="menu-label">
        Tutorial Steps
    </p>

    <ul class="steps is-vertical is-small menu-list">
        
        
            
            
            
            <li class="steps-segment">
            <span href="../project_setup/index.html"
                  class="steps-marker is-primary">1</span>
                <div class="steps-content">
                    <a href="../project_setup/index.html">Project Setup</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../project_cleanup/index.html"
                  class="steps-marker is-primary">2</span>
                <div class="steps-content">
                    <a href="../project_cleanup/index.html">Project Cleanup</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../styling/index.html"
                  class="steps-marker is-primary">3</span>
                <div class="steps-content">
                    <a href="../styling/index.html">Styling with TSLint</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../testing/index.html"
                  class="steps-marker is-primary">4</span>
                <div class="steps-content">
                    <a href="../testing/index.html">Unit Testing with Jest and Enzyme</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../nodejs_debugging/index.html"
                  class="steps-marker is-primary">5</span>
                <div class="steps-content">
                    <a href="../nodejs_debugging/index.html">Debugging During Testing With NodeJS</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../chrome_debugging/index.html"
                  class="steps-marker is-primary">6</span>
                <div class="steps-content">
                    <a href="../chrome_debugging/index.html">Debugging JSX With Chrome</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../jsx_es6/index.html"
                  class="steps-marker is-primary">7</span>
                <div class="steps-content">
                    <a href="../jsx_es6/index.html">JSX and ES6</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../functional_components/index.html"
                  class="steps-marker is-primary">8</span>
                <div class="steps-content">
                    <a href="../functional_components/index.html">Functional React Components in TypeScript</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../props/index.html"
                  class="steps-marker is-primary">9</span>
                <div class="steps-content">
                    <a href="../props/index.html">Sharing Component Props Using Type Information</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../class_props/index.html"
                  class="steps-marker is-primary">10</span>
                <div class="steps-content">
                    <a href="../class_props/index.html">Class Components With Props</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../class_state/index.html"
                  class="steps-marker is-primary">11</span>
                <div class="steps-content">
                    <a href="../class_state/index.html">Model Class State With TypeScript Interfaces</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../rich_events_and_testing/index.html"
                  class="steps-marker is-primary">12</span>
                <div class="steps-content">
                    <a href="../rich_events_and_testing/index.html">Rich Events and Testing</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="#"
                  class="steps-marker is-info">13</span>
                <div class="steps-content">
                    <a href="#">Presentation and Container Components</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../routing/index.html"
                  class="steps-marker is-primary">14</span>
                <div class="steps-content">
                    <a href="../routing/index.html">TypeScript and Routing With Testing</a>
                </div>
            </li>
        
    </ul>

</aside>
            </div>
        </div>
    </div>

</section>

<footer class="footer is-success">
    <div class="container">
        <div class="content has-text-centered">
            <p>
                Powered by Kaybee, which uses
                <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a>,
                <a href="http://bulma.io">Bulma</a>,
                <a href="http://dectate.readthedocs.io/en/latest/">Dectate</a>,
                <a href="https://pydantic-docs.helpmanual.io">pydantic</a>,
                and more.
            </p>
            <p id="kb-config-copyright">
                &copy; 2018, All Rights Reserved
            </p>
        </div>
    </div>
</footer>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT: '',
        VERSION: '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
    };
</script>

</body>
</html>
