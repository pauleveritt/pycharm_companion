<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Unit Testing with Jest and Enzyme</title>
    
        <link rel="icon"
              href="../../../_static/jetbrains_favicon.ico"/>
    
    <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css"
          rel="stylesheet">
    <script src="../../../_static/kaybee_bulma.bundle.js"></script>
    <script src="../../../_static/app.bundle.js"></script>
</head>
<body>

<section>
    <nav id="kbb-navbar" class="navbar is-success"
     role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="../../../index.html">
            
            <img src="../../../_static/PyCharm_Logo.svg.png"
                 alt="PyCharm Logo Alt">
        </a>
        <button class="button navbar-burger" data-target="navMenu">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </div>
    <div class="navbar-menu" id="navMenu">
        <div class="navbar-start">
            
                <a class="navbar-item"
                   href="../../../tips/index.html">
                    Tips
                </a>
            
                <a class="navbar-item is-active"
                   href="../../index.html">
                    Tutorials
                </a>
            
                <a class="navbar-item"
                   href="../../../articles/index.html">
                    Articles
                </a>
            
                <a class="navbar-item"
                   href="../../../blogposts/index.html">
                    Blog Posts
                </a>
            
                <a class="navbar-item"
                   href="../../../webinars/index.html">
                    Webinars
                </a>
            
                <a class="navbar-item"
                   href="../../../technologies/index.html">
                    Technologies
                </a>
            
                <a class="navbar-item"
                   href="../../../topics/index.html">
                    Topics
                </a>
            
                <a class="navbar-item"
                   href="../../../authors/index.html">
                    Authors
                </a>
            

        </div>

        <div class="navbar-end">
            
            
        </div>
    </div>
</nav>
</section>
<section
        class="hero is-success"
        style="">
    <div class="hero-head">
    </div>
    
</section>

<section class="section content tutorialstep"
         id="kbb-sphinx-body">
    
    <div class="container">
        <div class="columns">
            <div class="column sb_body">
                <nav class="breadcrumb has-arrow-separator is-small"
                     aria-label="breadcrumbs"
                     style="margin-bottom: 0">
                    <ul style="margin-left: 0">
                        
                            <li>
                                <a href="../../index.html">Tutorials</a>
                            </li>
                        
                            <li>
                                <a href="../index.html">React+TypeScript QuickStart</a>
                            </li>
                        
                        <li class="is-active">
                            <a href="#"
                               aria-current="page">Unit Testing with Jest and Enzyme</a>
                        </li>
                    </ul>
                </nav>
                <div class="title is-1">
                    Unit Testing with Jest and Enzyme
                    
    <span style="background-color: orange; color: white; font-weight: bold;
    font-size: x-small; padding: 0.5em; vertical-align: middle;
    border-radius: 25px">PRO ONLY</span>

                </div>

                <div class="subtitle is-4">The Jest test runner integrates productively into PyCharm. Let's put it to work to adopt a test-first approach, including Enzyme for testing convenience.</div>

                
                    <iframe
                            width="800"
                            height="360"
                            src="https://www.youtube.com/embed/BpyR07t4BfY"
                            frameborder="0"
                            allowfullscreen="True"></iframe>
                

                <div id="kbb-sphinx-body" class="content"><div class="section" id="unit-testing-with-jest-and-enzyme">
<h1>Unit Testing with Jest and Enzyme<a class="headerlink" href="#unit-testing-with-jest-and-enzyme" title="Permalink to this headline">¶</a></h1>
<p>We saw the <a class="reference internal" href="../../../technologies/jest.html" title="Jest"><em>Jest</em></a> test runner in
<a class="reference internal" href="../project_setup/index.html"><span class="doc">Project Setup</span></a>. We modified an existing test but didn’t dive
into testing.</p>
<p>In this tutorial step we start the process of test driven development. After
this step, we’ll develop first in our Jest tests. Then, only at the end, we
will look at the app in the browser.</p>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<p>The finished code for this tutorial step is
<a class="reference external" href="https://github.com/pauleveritt/pycharm_companion/tree/master/docs/tutorials/react_typescript/testing">on GitHub</a>.</p>
</div>
<div class="section" id="pretty-jest">
<h2>Pretty Jest<a class="headerlink" href="#pretty-jest" title="Permalink to this headline">¶</a></h2>
<p>Previously we ran our Jest tests as a generic npm run script, in the IDE’s
npm run tool window. However, PyCharm Professional has a dedicated run
configuration type for Jest. It’s a fantastic way to do development. Let’s
switch to using that.</p>
<p>Select <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">|</span> <span class="pre">Edit</span> <span class="pre">Configurations</span></code>, click <code class="docutils literal notranslate"><span class="pre">+</span></code>, and click on <code class="docutils literal notranslate"><span class="pre">Jest</span></code>.
Supply a <code class="docutils literal notranslate"><span class="pre">Name:</span></code> of something like <code class="docutils literal notranslate"><span class="pre">unit</span> <span class="pre">tests</span></code>. The only real field
you need to supply is <code class="docutils literal notranslate"><span class="pre">Jest</span> <span class="pre">options:</span></code>. For that, enter
<code class="docutils literal notranslate"><span class="pre">--env=jsdom</span> <span class="pre">--watchAll</span></code>. This tells Jest to re-run tests when files change
and to use the <a class="reference internal" href="../../../technologies/jsdom.html" title="jsdom"><em>jsdom</em></a> package as a fake browser.</p>
<a class="reference internal image-reference" href="../../../_images/run_config.png"><img alt="Custom run configuration type for Jest" src="../../../_images/run_config.png" style="width: 856px;" /></a>
<p>Save that run configuration and run it. Our tests now run in a nice tool
window which will make test-driven development (TDD) much more productive.</p>
</div>
<div class="section" id="fail-faster">
<h2>Fail Faster<a class="headerlink" href="#fail-faster" title="Permalink to this headline">¶</a></h2>
<p>Let’s see a little testing in action. Open <code class="docutils literal notranslate"><span class="pre">src/App.test.tsx</span></code>. We’re going to
show the cycle of fail-fix in action. Define two contants, then compare
them with a simple Jest (actually, Jasmine) assertion:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;renders without crashing&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
    <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span><span class="p">,</span> <span class="nx">div</span><span class="p">);</span>
    <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">unmountComponentAtNode</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
<span class="hll">    <span class="kr">const</span> <span class="nx">actual</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="hll">    <span class="kr">const</span> <span class="nx">expected</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span><span class="hll">    <span class="nx">expect</span><span class="p">(</span><span class="nx">actual</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">expected</span><span class="p">);</span>
</span><span class="p">});</span>
</pre></div>
</div>
<p>When you save this, Jest re-runs your tests, and does so quite fast. Our
tests fail, and the IDE’s tool window presents the test results in a very
convenient manner. For example, you can jump directly to the line of the
failing test.</p>
<a class="reference internal image-reference" href="../../../_images/failed_test.png"><img alt="Jest tool window shows which tests fail" src="../../../_images/failed_test.png" style="width: 868px;" /></a>
<p>Fix the test by changing <code class="docutils literal notranslate"><span class="pre">expected</span></code> to <code class="docutils literal notranslate"><span class="pre">1</span></code> then save. The Jest watcher
spots the change, re-runs the test very quickly, and shows that all tests
pass.</p>
</div>
<div class="section" id="tdd-basics">
<h2>TDD Basics<a class="headerlink" href="#tdd-basics" title="Permalink to this headline">¶</a></h2>
<p>JavaScript development is usually a bunch of switching between the editor,
the browser, the browser console, and a terminal window with the build tools
displaying messages. Let’s use a better flow. Let’s stay in the IDE and focus
on our code, and observe our code through tests instead of a browser reload.</p>
<p>First, let’s get our code and our tests side-by-side. Press <code class="docutils literal notranslate"><span class="pre">Ctrl-Alt-A</span></code> and
type in <code class="docutils literal notranslate"><span class="pre">Split</span> <span class="pre">Vertically</span></code>. This gives us a left and right side editor. On
the left, open <code class="docutils literal notranslate"><span class="pre">App.tsx</span></code>. We can now see <code class="docutils literal notranslate"><span class="pre">class</span> <span class="pre">App</span></code> alongside our tests.
If you need more room, close the Project tool window.</p>
<a class="reference internal image-reference" href="../../../_images/side_by_side.png"><img alt="Component and test side-by-side" src="../../../_images/side_by_side.png" style="width: 850px;" /></a>
<p>We often want to jump between our code and our test. The IDE makes this
easy. <code class="docutils literal notranslate"><span class="pre">Cmd-Shift-T</span></code> moves the cursor between code and test.</p>
</div>
<div class="section" id="a-real-test">
<h2>A Real Test<a class="headerlink" href="#a-real-test" title="Permalink to this headline">¶</a></h2>
<p>We currently have a test which makes a document, tells React to render our
component-under-test into it, and then…well, nothing really.
<a class="reference internal" href="../../../technologies/cra.html" title="create-react-app"><em>create-react-app</em></a> generates a test whose only purpose is to see if it
can render. Let’s look inside the rendered result and test its correctness.</p>
<p>To do so, we’re going to install <a class="reference internal" href="../../../technologies/enzyme.html" title="Enzyme"><em>Enzyme</em></a>, a utility for
React that makes testing feel like jQuery assertions. Open the IDE’s
<code class="docutils literal notranslate"><span class="pre">Terminal</span></code> tool and install Enzyme and its TypeScript typings:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ npm install -D enzyme enzyme-adapter-react-16 react-addons-test-utils <span class="se">\</span>
  @types/enzyme @types/enzyme-adapter-react-16
</pre></div>
</div>
<p>We need to tell Jest to use a configured Enzyme. Add this file at
<code class="docutils literal notranslate"><span class="pre">src/setupTests.ts</span></code>:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">Enzyme</span> <span class="nx">from</span> <span class="s1">&#39;enzyme&#39;</span>
<span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">Adapter</span> <span class="nx">from</span> <span class="s1">&#39;enzyme-adapter-react-16&#39;</span>

<span class="nx">Enzyme</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span>
    <span class="nx">adapter</span>: <span class="kt">new</span> <span class="nx">Adapter</span><span class="p">(),</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Restart the Jest run tool window to pickup this setup file. Then, edit
<code class="docutils literal notranslate"><span class="pre">src/App.test.tsx</span></code> to include a second test:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;renders the heading&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(&lt;</span><span class="nt">App</span><span class="p">/&gt;);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Hello React&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>You’ll see <code class="docutils literal notranslate"><span class="pre">shallow</span></code> in red, meaning it is a TypeScript error, because
<code class="docutils literal notranslate"><span class="pre">shallow</span></code> hasn’t been imported. Click on <code class="docutils literal notranslate"><span class="pre">shallow</span></code> and press
<code class="docutils literal notranslate"><span class="pre">Alt-Enter</span></code>. The IDE automatically generates the correct import.</p>
<p>You can now test the TDD style of development. Try changing the component’s
<code class="docutils literal notranslate"><span class="pre">&lt;h1&gt;</span></code> to contain different text and save. You’ll see the test fail. Change
it back and save, and the tests pass.</p>
<p>To see real TDD, you write the test first. Add a third test in
<code class="docutils literal notranslate"><span class="pre">src/App.test.tsx</span></code>:</p>
<div class="highlight-jsx notranslate"><div class="highlight"><pre><span></span><span class="nx">it</span><span class="p">(</span><span class="s1">&#39;renders the paragraph&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">shallow</span><span class="p">(&lt;</span><span class="nt">App</span><span class="p">/&gt;);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="s1">&#39;Nice TDD&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Good news, it fails! TDD starts with a failing test. You then implement what
you expect to pass. Change your <code class="docutils literal notranslate"><span class="pre">App</span></code> component in <code class="docutils literal notranslate"><span class="pre">src/App.tsx</span></code> to have
this markup:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello React<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Nice TDD<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>When you save, the test passes. Not only that…you extended your component
without looking at a browser.</p>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://www.jetbrains.com/help/webstorm/running-unit-tests-on-jest.html">https://www.jetbrains.com/help/webstorm/running-unit-tests-on-jest.html</a></li>
<li><a class="reference external" href="https://www.jetbrains.com/help/webstorm/run-debug-configuration-jest.html">https://www.jetbrains.com/help/webstorm/run-debug-configuration-jest.html</a></li>
<li><a class="reference external" href="https://blog.jetbrains.com/webstorm/tag/jest/">https://blog.jetbrains.com/webstorm/tag/jest/</a></li>
<li><a class="reference external" href="https://medium.com/kevin-salters-blog/testing-react-with-enzyme-fbfc30190e70">https://medium.com/kevin-salters-blog/testing-react-with-enzyme-fbfc30190e70</a></li>
<li><a class="reference external" href="https://javascriptplayground.com/introduction-to-react-tests-enzyme/">https://javascriptplayground.com/introduction-to-react-tests-enzyme/</a></li>
<li><a class="reference external" href="https://www.codementor.io/vijayst/unit-testing-react-components-jest-or-enzyme-du1087lh8">https://www.codementor.io/vijayst/unit-testing-react-components-jest-or-enzyme-du1087lh8</a></li>
<li><a class="reference external" href="https://github.com/Microsoft/TypeScript-React-Starter#typescript-react-starter">https://github.com/Microsoft/TypeScript-React-Starter#typescript-react-starter</a></li>
</ul>
</div>
</div>
</div>

            </div>

            <div class="column is-3">
                <aside id="sidebarCollapseTarget" class="menu kbb-sidenav">

    <div id="kb-sidenav-published-heading">
    

    
        <p class="menu-label">
            Published
        </p>
        <ul class="menu-list">
            <li>
                Published on
                2018-02-26
                at
                12:00
                
                    by:
                    
                        <a href="../../../authors/pauleveritt/index.html">
                            <figure class="image is-rounded is-24x24"
                                    style="display: inline-block; margin: 0.5rem">
                                <img src="../../../authors/pauleveritt/paul_headshotx24.jpeg">
                            </figure>
                            <span
                                    style="display: inline-block; vertical-align: super">Paul Everitt</span>
                        </a>
                    
                
            </li>
        </ul>
    
</div>
    
    <p class="menu-label">
        Previous
    </p>
    <ul class="menu-list">
        <a href="../styling/index.html"
           title="previous chapter">Styling with TSLint</a>
    </ul>



    <p class="menu-label">
        Next
    </p>
    <ul class="menu-list">
        <a href="../nodejs_debugging/index.html"
           title="next chapter">Debugging During Testing With NodeJS</a>
    </ul>


    
    

    
        <div>
            <p class="menu-label">
                <span style="text-transform: uppercase">technology</span>
            </p>
            <p>
                
                    <a href="../../../technologies/react.html">
                        <span class="tag">react</span>
                    </a>
                
                    <a href="../../../technologies/jest.html">
                        <span class="tag">jest</span>
                    </a>
                
                    <a href="../../../technologies/enzyme.html">
                        <span class="tag">enzyme</span>
                    </a>
                
            </p>
        </div>
    



    <p class="menu-label">
        Tutorial Steps
    </p>

    <ul class="steps is-vertical is-small menu-list">
        
        
            
            
            
            <li class="steps-segment">
            <span href="../project_setup/index.html"
                  class="steps-marker is-primary">1</span>
                <div class="steps-content">
                    <a href="../project_setup/index.html">Project Setup</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../project_cleanup/index.html"
                  class="steps-marker is-primary">2</span>
                <div class="steps-content">
                    <a href="../project_cleanup/index.html">Project Cleanup</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../styling/index.html"
                  class="steps-marker is-primary">3</span>
                <div class="steps-content">
                    <a href="../styling/index.html">Styling with TSLint</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="#"
                  class="steps-marker is-info">4</span>
                <div class="steps-content">
                    <a href="#">Unit Testing with Jest and Enzyme</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../nodejs_debugging/index.html"
                  class="steps-marker is-primary">5</span>
                <div class="steps-content">
                    <a href="../nodejs_debugging/index.html">Debugging During Testing With NodeJS</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../chrome_debugging/index.html"
                  class="steps-marker is-primary">6</span>
                <div class="steps-content">
                    <a href="../chrome_debugging/index.html">Debugging JSX With Chrome</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../jsx_es6/index.html"
                  class="steps-marker is-primary">7</span>
                <div class="steps-content">
                    <a href="../jsx_es6/index.html">JSX and ES6</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../functional_components/index.html"
                  class="steps-marker is-primary">8</span>
                <div class="steps-content">
                    <a href="../functional_components/index.html">Functional React Components in TypeScript</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../props/index.html"
                  class="steps-marker is-primary">9</span>
                <div class="steps-content">
                    <a href="../props/index.html">Sharing Component Props Using Type Information</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../class_props/index.html"
                  class="steps-marker is-primary">10</span>
                <div class="steps-content">
                    <a href="../class_props/index.html">Class Components With Props</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../class_state/index.html"
                  class="steps-marker is-primary">11</span>
                <div class="steps-content">
                    <a href="../class_state/index.html">Model Class State With TypeScript Interfaces</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../rich_events_and_testing/index.html"
                  class="steps-marker is-primary">12</span>
                <div class="steps-content">
                    <a href="../rich_events_and_testing/index.html">Rich Events and Testing</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../presentation_components/index.html"
                  class="steps-marker is-primary">13</span>
                <div class="steps-content">
                    <a href="../presentation_components/index.html">Presentation and Container Components</a>
                </div>
            </li>
        
            
            
            
            <li class="steps-segment">
            <span href="../routing/index.html"
                  class="steps-marker is-primary">14</span>
                <div class="steps-content">
                    <a href="../routing/index.html">TypeScript and Routing With Testing</a>
                </div>
            </li>
        
    </ul>

</aside>
            </div>
        </div>
    </div>

</section>

<footer class="footer is-success">
    <div class="container">
        <div class="content has-text-centered">
            <p>
                Powered by Kaybee, which uses
                <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a>,
                <a href="http://bulma.io">Bulma</a>,
                <a href="http://dectate.readthedocs.io/en/latest/">Dectate</a>,
                <a href="https://pydantic-docs.helpmanual.io">pydantic</a>,
                and more.
            </p>
            <p id="kb-config-copyright">
                &copy; 2018, All Rights Reserved
            </p>
        </div>
    </div>
</footer>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT: '',
        VERSION: '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
    };
</script>

</body>
</html>
